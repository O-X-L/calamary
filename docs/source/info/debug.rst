.. _debug:

.. include:: ../_inc/head.rst

.. include:: ../_inc/in_progress.rst

#####
Debug
#####

If you encounter any unexpected behaviour you might want to enable the :code:`debug` mode in your config-file to let Calamary produce more verbose logs.

Examples
########

Tranparent Mode - Plaintext HTTP
================================

.. code-block:: bash

    2023-10-02 00:10:30 | DEBUG | service | Accept: tcp://127.0.0.1:4128
    2023-10-02 00:10:30 | DEBUG | parse | 192.168.11.104 => ? | Parsing TCP connection
    2023-10-02 00:10:30 | DEBUG | parse | 192.168.11.104 => 135.181.170.219:80 | Processing TCP
    2023-10-02 00:10:30 | DEBUG | parse | 192.168.11.104 => 135.181.170.219:80 | TLS information: IsTls=false, TlsVersion=0, TlsSni=
    2023-10-02 00:10:30 | DEBUG | parse | 192.168.11.104 => 135.181.170.219:80 | Packet L5Proto: HTTP | TLS: none
    2023-10-02 00:10:30 | DEBUG | filter | 192.168.11.104 => 135.181.170.219:80 | Rule 0 - DNet: [192.168.100.0/24] vs 135.181.170.219
    2023-10-02 00:10:30 | DEBUG | filter | 192.168.11.104 => 135.181.170.219:80 | Rule 1 - !DPort: [443 80] vs 80
    2023-10-02 00:10:30 | DEBUG | filter | 192.168.11.104 => 135.181.170.219:80 | Rule 2 - Proto L4: [10] vs 10
    2023-10-02 00:10:30 | DEBUG | filter | 192.168.11.104 => 135.181.170.219:80 | Rule 2 - SNet: [192.168.0.0/16 172.16.0.0/12 10.0.0.0/8] vs 192.168.11.104
    2023-10-02 00:10:30 | DEBUG | filter | 192.168.11.104 => 135.181.170.219:80 | Rule 2 - DNet: [192.168.0.0/16 172.16.0.0/12 10.0.0.0/8] vs 135.181.170.219
    2023-10-02 00:10:30 | DEBUG | filter | 192.168.11.104 => 135.181.170.219:80 | Rule 3 - Proto L4: [10] vs 10
    2023-10-02 00:10:30 | DEBUG | filter | 192.168.11.104 => 135.181.170.219:80 | Rule 3 - !DNet: [192.168.0.0/16 172.16.0.0/12 10.0.0.0/8] vs 135.181.170.219
    2023-10-02 00:10:30 | DEBUG | filter | 192.168.11.104 => 135.181.170.219:80 | Rule 3 - DPort: [443 80] vs 80
    2023-10-02 00:10:30 | DEBUG | filter | 192.168.11.104 => 135.181.170.219:80 | Rule 3 - Applying action 'accept'
    2023-10-02 00:10:30 | INFO | forward | 192.168.11.104 => 135.181.170.219:80 | Accept
    2023-10-02 00:10:30 | DEBUG | send | 192.168.11.104 => 135.181.170.219:80 | Connection established
    2023-10-02 00:10:30 | DEBUG | send | 192.168.11.104 => 135.181.170.219:80 | Forwarding
    2023-10-02 00:10:30 | DEBUG | send | 192.168.11.104 => 135.181.170.219:80 | 5 bytes sent
    2023-10-02 00:10:30 | DEBUG | send | 192.168.11.104 => 135.181.170.219:80 | 76 bytes sent
    2023-10-02 00:10:30 | DEBUG | send | 192.168.11.104 => 135.181.170.219:80 | 351 bytes received
    2023-10-02 00:10:30 | DEBUG | send | 192.168.11.104 => 135.181.170.219:80 | Closed

Tranparent Mode - HTTPS
=======================

.. code-block:: bash

    2023-10-02 00:13:20 | DEBUG | service | Accept: tcp://127.0.0.1:4128
    2023-10-02 00:13:20 | DEBUG | parse | 192.168.11.104 => ? | Parsing TCP connection
    2023-10-02 00:13:20 | DEBUG | parse | 192.168.11.104 => 135.181.170.219:443 | Processing TCP
    2023-10-02 00:13:20 | DEBUG | parse | 192.168.11.104 => 135.181.170.219:443 | TLS information: IsTls=true, TlsVersion=771, TlsSni=superstes.eu
    2023-10-02 00:13:20 | DEBUG | parse | 192.168.11.104 => 135.181.170.219:443 | Packet L5Proto: TLS | TLS: 1.2
    2023-10-02 00:13:20 | DEBUG | filter | 192.168.11.104 => 135.181.170.219:443 | Rule 0 - DNet: [192.168.100.0/24] vs 135.181.170.219
    2023-10-02 00:13:20 | DEBUG | filter | 192.168.11.104 => 135.181.170.219:443 | Rule 1 - !DPort: [443 80] vs 443
    2023-10-02 00:13:20 | DEBUG | filter | 192.168.11.104 => 135.181.170.219:443 | Rule 2 - Proto L4: [10] vs 10
    2023-10-02 00:13:20 | DEBUG | filter | 192.168.11.104 => 135.181.170.219:443 | Rule 2 - SNet: [192.168.0.0/16 172.16.0.0/12 10.0.0.0/8] vs 192.168.11.104
    2023-10-02 00:13:20 | DEBUG | filter | 192.168.11.104 => 135.181.170.219:443 | Rule 2 - DNet: [192.168.0.0/16 172.16.0.0/12 10.0.0.0/8] vs 135.181.170.219
    2023-10-02 00:13:20 | DEBUG | filter | 192.168.11.104 => 135.181.170.219:443 | Rule 3 - Proto L4: [10] vs 10
    2023-10-02 00:13:20 | DEBUG | filter | 192.168.11.104 => 135.181.170.219:443 | Rule 3 - !DNet: [192.168.0.0/16 172.16.0.0/12 10.0.0.0/8] vs 135.181.170.219
    2023-10-02 00:13:20 | DEBUG | filter | 192.168.11.104 => 135.181.170.219:443 | Rule 3 - DPort: [443 80] vs 443
    2023-10-02 00:13:20 | DEBUG | filter | 192.168.11.104 => 135.181.170.219:443 | Rule 3 - Applying action 'accept'
    2023-10-02 00:13:20 | INFO | forward | 192.168.11.104 => 135.181.170.219:443 | Accept
    2023-10-02 00:13:20 | DEBUG | send | 192.168.11.104 => 135.181.170.219:443 | Connection established
    2023-10-02 00:13:20 | DEBUG | send | 192.168.11.104 => 135.181.170.219:443 | Forwarding
    2023-10-02 00:13:20 | DEBUG | send | 192.168.11.104 => 135.181.170.219:443 | 517 bytes sent
    2023-10-02 00:13:20 | DEBUG | send | 192.168.11.104 => 135.181.170.219:443 | 4096 bytes received
    ...
    2023-10-02 00:13:20 | DEBUG | send | 192.168.11.104 => 135.181.170.219:443 | 842 bytes sent
    2023-10-02 00:13:20 | DEBUG | send | 192.168.11.104 => 135.181.170.219:443 | Closed
